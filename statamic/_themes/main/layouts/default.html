<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    {{ _site_name }}
    {{ if segment_1 }}
    â€“ {{ title|lower|slugify }}
    {{ endif }}
  </title>


    <script src="{{ theme:js src="modernizr.custom" }}"></script>

   <!-- <script src="http://192.168.0.1:35729/livereload.js?snipver=1"></script> -->
 {{ theme:css src="main" tag="true" }}



  <link rel="icon" href="{{ theme:img src="favicon.ico" }}" />
<style>

</style>
</head>

    <body class="cbp-spmenu-push" data-spy="scroll" data-target=".cbp-spmenu">


    {{ theme:partial src="nav" }}

    {{ layout_content }}
    


  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="{{ theme:js src="main" }}"></script>

<script>

$( function()
{
  var activityIndicatorOn = function()
    {
      $( '<div id="imagelightbox-loading"><div></div></div>' ).appendTo( 'body' );
    },
    activityIndicatorOff = function()
    {
      $( '#imagelightbox-loading' ).remove();
    },

    overlayOn = function()
    {
      $( '<div id="imagelightbox-overlay"></div>' ).appendTo( 'body' );
    },
    overlayOff = function()
    {
      $( '#imagelightbox-overlay' ).remove();
    },

    closeButtonOn = function( instance )
    {
      $( '<a href="#" id="imagelightbox-close">Close</a>' ).appendTo( 'body' ).on( 'click touchend', function(){ $( this ).remove(); instance.quitImageLightbox(); return false; });
    },
    closeButtonOff = function()
    {
      $( '#imagelightbox-close' ).remove();
      $( '#imagelightbox-container' ).remove();
    },
    headerOn = function()
    {
      var description = $( 'a[href="' + $( '#imagelightbox' ).attr( 'src' ) + '"] img' ).attr( 'header' );
      if( description.length > 0 )
        $( '<div id="imagelightbox-header">' + '<h3>' + description + '</h3>' + '</div>' ).prependTo( '#header' );
    },
    headerOnCompanies = function()
    {
      var description = $( 'a[href="' + $( '#imagelightbox' ).attr( 'src' ) + '"] img' ).attr( 'header' );
      if( description.length > 0 )
        $( '<div id="imagelightbox-header">' + '<h2>' + description + '</h2>' + '</div>' ).prependTo( '#header-companies-wrapper' );
    },
    headerOff = function()
    {
      $( '#imagelightbox-header' ).remove();
    },
    captionOn = function()
    {
      var description = $( 'a[href="' + $( '#imagelightbox' ).attr( 'src' ) + '"] img' ).attr( 'caption' );
      if( description.length > 0 )
        $( '<div id="imagelightbox-caption">' + description + '</div>' ).prependTo( '#header' );
    },
    captionOnCompanies = function()
    {
      var description = $( 'a[href="' + $( '#imagelightbox' ).attr( 'src' ) + '"] img' ).attr( 'alt' );
      if( description.length > 0 )
        $( '<div id="imagelightbox-caption">' + description + '</div>' ).appendTo( '#header-companies-wrapper' );
    },
    captionOff = function()
    {
      $( '#imagelightbox-caption' ).remove();
    },
    navigationOn = function( instance, selector )
    {
      var images = $( selector );
      if( images.length > 0 )
      {
        var nav = $( '<div id="imagelightbox-nav"></div>' );
        for( var i = 0; i < images.length; i++ )
          nav.append( '<a href="#"></a>' );

        nav.appendTo( '#imagelightbox-container' );
        nav.on( 'click touchend', function(){ return false; });

        var navItems = nav.find( 'a' );
        navItems.on( 'click touchend', function()
        {
          var $this = $( this );
          if( images.eq( $this.index() ).attr( 'href' ) != $( '#imagelightbox' ).attr( 'src' ) )
            instance.switchImageLightbox( $this.index() );

          navItems.removeClass( 'active' );
          navItems.eq( $this.index() ).addClass( 'active' );

          return false;
        })
        .on( 'touchend', function(){ return false; });
      }
    },
    navigationUpdate = function( selector )
    {
      var items = $( '#imagelightbox-nav a' );
      items.removeClass( 'active' );
      items.eq( $( selector ).filter( '[href="' + $( '#imagelightbox' ).attr( 'src' ) + '"]' ).index( selector ) ).addClass( 'active' );
    },
    navigationOff = function()
    {
      $( '#imagelightbox-nav' ).remove();
    };

    moveNav = function() {
        $('#imagelightbox-nav').insertAfter('#imagelightbox');
    };

    addWrap = function() {
        $('#header').addClass('wrapAll');
        $('#imagelightbox').addClass('wrapAll');
        $('#imagelighbox-nav').addClass('wrapAll');
    };

    wrapAll = function() {
        $('.wrapAll').wrapAll("<div class='imagelightbox-wrapper' />");
    };

    {{ entries:listing folder="case-studies/entries" sort_by="numeric" sort_dir="desc" }}

        var selector{{ title|lower|slugify }} = 'a[data-imagelightbox="{{ title|lower|slugify }}"]';
        var instance{{ title|lower|slugify }} = $( selector{{ title|lower|slugify }} ).imageLightbox(
        {
          quitOnDocClick: false,
          onStart:   function() {  overlayOn( instance{{ title|lower|slugify }}, selector{{ title|lower|slugify }} ); closeButtonOn( instance{{ title|lower|slugify }}, selector{{ title|lower|slugify }} ); navigationOn( instance{{ title|lower|slugify }}, selector{{ title|lower|slugify }} );},
          onEnd:     function() { navigationOff(); activityIndicatorOff(); closeButtonOff(); captionOff(); headerOff(); overlayOff(); },
          onLoadStart: function() { captionOff(); headerOff();  activityIndicatorOn(); },
          onLoadEnd:   function() { headerOn();  navigationUpdate( selector{{ title|lower|slugify }} ); activityIndicatorOff();  addWrap(); wrapAll(); moveNav();}
        });
    {{ /entries:listing }}


});


</script>

</body>
</html>
